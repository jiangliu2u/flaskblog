!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&(define.amd||define.cmd)?define(e):t.showIMG=e()}(this,function(){"use strict";var t=function(){function t(t){var e,i,s=null!=t.style.opacity,n=/alpha\(opacity=([\d.]+)\)/i;return s?(i=t.style.opacity||getComputedStyle(t,null).opacity,""==i?100:100*i):(e=t.style.filter||t.currentStyle.filter,e&&(i=e.match(n)),null==i||null==e?100:i[1])}function e(t,e){null!=t.style.opacity?t.style.opacity=e/100:t.style.filter="alpha(opacity="+e+")"}function i(e,i){return"opacity"===i.toLowerCase()?t(e):e.currentStyle?e.currentStyle[i]:getComputedStyle(e,null)[i]}function s(t,i,s){switch(i){case"left":case"right":case"top":case"bottom":s=parseFloat(s)+"px";break;case"width":case"height":s=parseFloat(s)<0?0:parseFloat(s)+"px"}"opacity"===i.toLowerCase()?e(t,s):t.style[i]=s}function n(t,e,n){if(t="string"==typeof t?document.getElementById(t):t){var a,o,n=n||{},h=n.duration||400,r=n.fps||60,c=n.easing||function(t){return t},l=n.callback||function(){},d=arguments,u=0,y=0;3===d.length?("number"==typeof d[2]&&(h=d[2]),"function"==typeof d[2]&&(l=d[2])):4===d.length&&("number"==typeof d[2]&&(h=d[2]),"function"==typeof d[3]&&(l=d[3]));for(a in e)y++;for(o in e)!function(n){function a(){var e=new Date-0,i=e-p,l=c(i/h);s(t,n,parseInt(d+l*f)),i>h?o():setTimeout(a,1e3/r)}function o(){s(t,n,m),++u===y&&l&&l()}var d=parseInt(i(t,n)),m=parseInt(e[n]),f=m-d,p=new Date-0;if(d==m)return o();a()}(o)}}function a(t,e,i){return t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i}function o(t,e,i){return t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=null}function h(t){return document.createElement(t)}function r(t,e){for(var i in e)s(t,i,e[i])}function c(t,e){if(document.getElementsByClassName)return(e||document).getElementsByClassName(t);for(var i=[],s=new RegExp("(^| )"+t+"( |$)"),n=(e||document).getElementsByTagName("*"),a=0,o=n.length;a<o;a++)s.test(n[a].className)&&i.push(n[a]);return i}return{on:a,off:o,create:h,css:r,getClass:c,animate:n}}(),e=function(e){e=e||{},this.doc=document.documentElement,this.body=document.body,this.wrapper=("string"==typeof e.el?document.getElementById(e.el):e.el)||this.body,this.images=t.getClass(e.boxClass||"boxClass",this.wrapper),this.images.length<1&&(this.images=this.wrapper.getElementsByTagName("img")),this.length=this.images.length,this.length<1||(this.showTitle=e.showTitle||!1,this.useMouse=e.useMouse||!1,this.useKeyboard=e.useKeyboard||!1,this.before=e.before||function(){},this.after=e.after||function(){},this.index=0,this.imgSrc=[],this.imgTitle=[],this._init())};return e.prototype={_init:function(){this._initEvent()},_initEvent:function(){var e=this;this._getSize(),this._getImage(),t.on(this.wrapper,"click",function(t){var t=t||window.event,i=t.target||t.srcElement;t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,"IMG"===i.tagName.toUpperCase()&&i.getAttribute("data-box-index")&&(e.index=i.getAttribute("data-box-index")-1,e._show())})},_getImage:function(){for(var t=0,e=null;t<this.length;t++)e=this.images[t],this.imgSrc.push(e.src),e.setAttribute("data-box-index",t+1),this.showTitle&&(e.title?this.imgTitle.push(e.title):this.imgTitle.push(""))},_getSize:function(){this.windowW=this.doc.clientWidth||this.body.clientWidth,this.windowH=this.doc.clientHeight||this.body.clientHeight,"CSS1Compat"!=document.compatMode&&(this.windowW=this.body.clientWidth,this.windowH=this.body.clientHeight)},_bindEvent:function(){var e=this;t.on(this.maskLayer,"click",function(){e._hide()}),t.on(this.closeLayer,"click",function(){e._hide()}),t.on(this.prevLayer,"click",function(){e._prevImg()}),t.on(this.nextLayer,"click",function(){e._nextImg()}),t.on(window,"resize",function(){e._resize()}),this.useMouse&&this._mouseImg(),this.useKeyboard&&this._keyboardImg()},_initCreate:function(){this.maskLayer=t.create("div"),this.maskLayer.className="lbsbox_maskLayer",this.showLayer=t.create("div"),this.showLayer.className="lbsbox_showLayer",this.imgLayer=t.create("img"),this.prevLayer=t.create("div"),this.prevLayer.className="lbsbox_prev",this.nextLayer=t.create("div"),this.nextLayer.className="lbsbox_next",this.closeLayer=t.create("div"),this.closeLayer.className="lbsbox_close",t.css(this.showLayer,{opacity:0,width:300,height:300,left:(this.windowW-300)/2,top:(this.windowH-300)/2}),t.css(this.maskLayer,{opacity:0,height:this.windowH}),this.showLayer.appendChild(this.imgLayer),this.showLayer.appendChild(this.prevLayer),this.showLayer.appendChild(this.nextLayer),this.showLayer.appendChild(this.closeLayer),this.showTitle&&this._createTitle()},_createTitle:function(){this.titleLayer=t.create("div"),this.titleLayer.className="lbsbox_titleLayer",this.showLayer.appendChild(this.titleLayer)},_show:function(){this.showLayer||(this._initCreate(),this._bindEvent()),this.status="show",this.body.appendChild(this.maskLayer),this.body.appendChild(this.showLayer),t.css(this.doc,{overflow:"hidden"}),t.css(this.body,{overflow:"hidden"}),t.animate(this.maskLayer,{opacity:75},300),t.animate(this.showLayer,{opacity:100},300),this._playImg()},_hide:function(){var e=this;this.status="hide",t.css(this.doc,{overflow:""}),t.css(this.body,{overflow:""}),t.animate(this.maskLayer,{opacity:0},300,function(){e.body.removeChild(e.maskLayer)}),t.animate(this.showLayer,{opacity:0},300,function(){e.body.removeChild(e.showLayer)})},_playImg:function(){var t=this;this.showTitle&&(this.titleLayer.innerHTML="<b>"+(this.index+1)+"/"+this.length+"</b>"+this.imgTitle[this.index]),this.before&&this.before(this.index),this._src=this.imgSrc[this.index],this._loadImg(this._src,function(e,i){t.status="play",t._animateImg(e,i)})},_loadImg:function(t,e){var i=new Image;i.onload=function(){e(i.width,i.height),i.onload=null},i.src=t},_animateImg:function(e,i){var s,n,a=this,o=this.windowW-20,h=this.windowH-20,r=e/i,c=i/e;e>o&&(e=o-10,i=e*c-10),i>h&&(i=h-10,e=i*r-10),this._width=e,this._height=i,s=(this.windowW-e-20)/2,n=(this.windowH-i-20)/2,s<10&&(s=10),n<10&&(n=10),this.showTitle&&t.css(this.titleLayer,{height:0,opacity:0}),t.css(this.imgLayer,{width:e,height:i,opacity:0}),this.imgLayer.src=this._src,t.animate(this.showLayer,{width:e,height:i,left:s,top:n},250,function(){t.animate(a.imgLayer,{opacity:100},250,function(){a.showTitle&&t.animate(a.titleLayer,{height:35,opacity:100},200),a.status="stop",a.after&&a.after(a.index)})})},_nextImg:function(){"play"!==this.status&&(this.index++,this.index>this.length-1&&(this.index=0),this._playImg())},_prevImg:function(){"play"!==this.status&&(this.index--,this.index<0&&(this.index=this.length-1),this._playImg())},_resize:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout(function(){e._getSize(),t.css(e.maskLayer,{height:e.windowH}),t.css(e.showLayer,{left:(e.windowW-e._width-20)/2,top:(e.windowH-e._height-10)/2})},60)},_mouseImg:function(){var e=this,i=function(t){if("hide"!==e.status){var i=0,t=t||window.event;i=t.wheelDelta?t.wheelDelta/120:-(t.detail||0)/3,i<0?e._nextImg():e._prevImg()}};window.netscape?t.on(document,"DOMMouseScroll",i):t.on(document,"mousewheel",i)},_keyboardImg:function(){var e=this;t.on(document,"keydown",function(t){if("hide"!==e.status)switch(t=t||window.event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.keyCode){case 37:case 38:case 33:e._prevImg();break;case 39:case 40:case 34:e._nextImg();break;case 27:e._hide()}})}},e});